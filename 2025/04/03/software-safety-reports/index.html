<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>软件安全课程报告汇总 | shingeki的博客</title><meta name="author" content="shingeki"><meta name="copyright" content="shingeki"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="24年秋软院软件安全课程报告汇总，有的内容可能比较粗糙。">
<meta property="og:type" content="article">
<meta property="og:title" content="软件安全课程报告汇总">
<meta property="og:url" content="https://youzhoujimrliu.github.io/2025/04/03/software-safety-reports/index.html">
<meta property="og:site_name" content="shingeki的博客">
<meta property="og:description" content="24年秋软院软件安全课程报告汇总，有的内容可能比较粗糙。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232317140.jpg">
<meta property="article:published_time" content="2025-04-03T15:14:39.000Z">
<meta property="article:modified_time" content="2025-04-04T04:14:12.500Z">
<meta property="article:author" content="shingeki">
<meta property="article:tag" content="软件安全">
<meta property="article:tag" content="AFL">
<meta property="article:tag" content="模糊测试">
<meta property="article:tag" content="Crackme">
<meta property="article:tag" content="Metasploit">
<meta property="article:tag" content="kali">
<meta property="article:tag" content="MS08-067">
<meta property="article:tag" content="漏洞">
<meta property="article:tag" content="熊猫烧香">
<meta property="article:tag" content="OllyDBG">
<meta property="article:tag" content="DVWA">
<meta property="article:tag" content="Seay">
<meta property="article:tag" content="RIPS">
<meta property="article:tag" content="CodeXploiter">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232317140.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "软件安全课程报告汇总",
  "url": "https://youzhoujimrliu.github.io/2025/04/03/software-safety-reports/",
  "image": "https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232317140.jpg",
  "datePublished": "2025-04-03T15:14:39.000Z",
  "dateModified": "2025-04-04T04:14:12.500Z",
  "author": [
    {
      "@type": "Person",
      "name": "shingeki",
      "url": "https://youzhoujimrliu.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://youzhoujimrliu.github.io/2025/04/03/software-safety-reports/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '软件安全课程报告汇总',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background: linear-gradient(9deg, rgba(122,167,255,0.8487044475993523) 10%, rgba(107,9,121,0.7394607501203607) 65%, rgba(255,163,0,0.5209733551623774) 100%);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250402112624099.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232317140.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">shingeki的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">软件安全课程报告汇总</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">软件安全课程报告汇总</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-03T15:14:39.000Z" title="发表于 2025-04-03 23:14:39">2025-04-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-04T04:14:12.500Z" title="更新于 2025-04-04 12:14:12">2025-04-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BD%9C%E4%B8%9A-%E6%8A%A5%E5%91%8A/">作业/报告</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="DVWA实验"><a href="#DVWA实验" class="headerlink" title="DVWA实验"></a>DVWA实验</h1><h2 id="一、DVWA安装配置"><a href="#一、DVWA安装配置" class="headerlink" title="一、DVWA安装配置"></a>一、DVWA安装配置</h2><p>这一部分参考博客<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41705207/article/details/109579027">https://blog.csdn.net/qq_41705207/article/details/109579027</a></p>
<p>1 在github上获取DVWA，具体地址为<a target="_blank" rel="noopener" href="https://github.com/digininja/DVWA/releases">https://github.com/digininja/DVWA/releases</a></p>
<p>2 利用phpstudy启动DVWA，将DVWA存入指定目录。</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232806883.png"></p>
<p>3 启动phpstudy，开启Apache，同时发现Mysql与本机上服务冲突无法启动，直接利用本机服务即可。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232900762.png" style="zoom:67%;" />

<p>4 修改DVWA配置，使得其与本机mysql配置一致。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233140308.png" style="zoom:80%;" />

<p>5 输入地址<a target="_blank" rel="noopener" href="http://127.0.0.1/DVWA-2.4%EF%BC%8C%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AEDVWA%E3%80%82">http://127.0.0.1/DVWA-2.4，开始配置DVWA。</a></p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233227691.png" alt="image-20250105133642702" style="zoom: 50%;" />

<p>6 发现配置中出现两个错误。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233231052.png" alt="image-20250105133934986" style="zoom:67%;" />

<p>7 对于第一个错误，找到phpstudy中对应配置文件进行修改。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233237389.png" alt="image-20250105134154616" style="zoom:50%;" />

<p>8 对于第二个错误，找到dvwa配置文件中有关部分修改。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233240239.png" alt="image-20250105134627215" style="zoom:67%;" />

<p>9 重启phpstudy后发现错误已经修正。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233242914.png" alt="image-20250105134713874" style="zoom:50%;" />

<p>10 创建数据库后即可登录DVWA。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233246356.png" alt="image-20250105134955078" style="zoom:67%;" />

<h2 id="二、利用Seay进行源代码审查"><a href="#二、利用Seay进行源代码审查" class="headerlink" title="二、利用Seay进行源代码审查"></a>二、利用Seay进行源代码审查</h2><p>1 新建项目，选择DVWA。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233250210.png" alt="image-20250105153918077" style="zoom: 50%;" />

<p>2 利用自动审计扫描漏洞，一共发现61个漏洞。针对每个漏洞给出了漏洞描述、文件路径以及详细代码位置。</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233255375.png" alt="image-20250105154102998"></p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233300670.png" alt="image-20250105154247510" style="zoom:67%;" />

<h2 id="三、利用RIPS进行源代码审查"><a href="#三、利用RIPS进行源代码审查" class="headerlink" title="三、利用RIPS进行源代码审查"></a>三、利用RIPS进行源代码审查</h2><p>1 在网络上获取RIPS，具体地址为 <a target="_blank" rel="noopener" href="https://sourceforge.net/projects/rips-scanner/files/latest/download">https://sourceforge.net/projects/rips-scanner/files/latest/download</a> ，并解压到phpstudy的指定目录下，即与DVWA同级别。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233304201.png" alt="image-20250105155107307" style="zoom: 67%;" />

<p>2 输入地址<a target="_blank" rel="noopener" href="http://127.0.0.1/rips-0.55/%EF%BC%8C%E8%BF%9B%E5%85%A5RIPS">http://127.0.0.1/rips-0.55/，进入RIPS</a></p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233307227.png" alt="image-20250105155231162" style="zoom:50%;" />

<p>3 输入DVWA的地址，进行扫描，一共检出39个漏洞。RIPS对这些漏洞的类型进行了分类。RIPS同样给出了漏洞的具体位置。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233311682.png" alt="image-20250105155726981" style="zoom:50%;" />

<h2 id="四、利用CodeXploiter进行源代码审查"><a href="#四、利用CodeXploiter进行源代码审查" class="headerlink" title="四、利用CodeXploiter进行源代码审查"></a>四、利用CodeXploiter进行源代码审查</h2><p>选择DVWA中的php文件，扫描后共发现与文件获取、SQL注入有关的三个漏洞。展开可以看到更详细的信息。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233316143.png" alt="image-20250105160403185" style="zoom:67%;" />

<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233320254.png" alt="image-20250105160621393" style="zoom:67%;" />

<h2 id="五、工具对比"><a href="#五、工具对比" class="headerlink" title="五、工具对比"></a>五、工具对比</h2><p>Seay检出的漏洞明显多于另外两种工具；但其检查所需时间也更长。</p>
<p>CodeXploiter检出的漏洞过少，可能并不可靠；Seay检出漏洞多，但也有误报可能。</p>
<p>Seay对于漏洞位置的描述最为详细，RIPS次之，CodeXploiter最粗略。</p>
<hr>
<h1 id="AFL实验报告"><a href="#AFL实验报告" class="headerlink" title="AFL实验报告"></a>AFL实验报告</h1><p>本实验利用**AFL (American Fuzzy Lop)**针对一段C语言代码进行模糊测试。</p>
<p>部分步骤参考博客<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45100742/article/details/134177614">https://blog.csdn.net/weixin_45100742/article/details/134177614</a></p>
<h2 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h2><p>虚拟机上已经提前安装好<strong>make、gcc</strong>等依赖。</p>
<p>1 从github上（  <a target="_blank" rel="noopener" href="https://github.com/google/AFL/releases/tag/v2.57b">https://github.com/google/AFL/releases/tag/v2.57b</a>  ）获取AFL源代码，解压到本地。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233701332.png" alt="image-20250105203354367" style="zoom:67%;" />

<p>2 随后运行<strong>make install</strong>命令，AFL已经安装好。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250404121411102.png" alt="image-20250105203509397" style="zoom:67%;" />

<h2 id="二、C程序准备"><a href="#二、C程序准备" class="headerlink" title="二、C程序准备"></a>二、C程序准备</h2><p>1 网络上寻找一段可能出错的程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 功能：两数加减乘除（一个整数、一个字符、再一个整数），然后根据中间这个字符当作运算符，输出四则运算结果。 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    <span class="type">char</span> op;</span><br><span class="line">    <span class="type">int</span> result;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d%c%d&quot;</span>, &amp;a, &amp;op, &amp;b))&#123;</span><br><span class="line">        <span class="keyword">switch</span> (op) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                result = a + b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                result = a - b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">                result = a * b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">                result = a / b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, result);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2 构建模糊测试种子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;1+2&#x27; &gt; seeds/seed1</span><br></pre></td></tr></table></figure>

<p>3 利用AFL编译程序：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233705159.png" alt="image-20250105205629593" style="zoom:67%;" />

<h2 id="三、测试"><a href="#三、测试" class="headerlink" title="三、测试"></a>三、测试</h2><p>1 运行命令 <strong>afl-fuzz -i seeds&#x2F; -o fuzz_output .&#x2F;test</strong> ，开始测试，出现报错</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233709265.png" alt="image-20250105235911716" style="zoom:67%;" />

<p>2 阅读报错信息发现，获取权限后，执行给出的 <strong>echo core &gt;&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;core_pattern</strong> 命令即可解决。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233714801.png" alt="image-20250106002500719" style="zoom:67%;" />

<p>3 ctrl+c，主动结束测试。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233719190.png" alt="image-20250106002543273" style="zoom:67%;" />

<h2 id="四、结果分析"><a href="#四、结果分析" class="headerlink" title="四、结果分析"></a>四、结果分析</h2><p>由上图可知，测试过程中出现了一个崩溃，并没有发生超时。</p>
<p>以下是AFL测试的输出结果：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233725470.png" alt="image-20250106110411955" style="zoom: 67%;" />

<p>其中crashes中是导致崩溃的测试用例，hangs中是代表超时的测试用例。</p>
<p>打开crashes文件夹，发现一个导致崩溃的测试用例为1&#x2F;0，此时发生除零异常。而hangs文件夹为空。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233729565.png" alt="image-20250106110553292" style="zoom:67%;" />

<p>测试发现1&#x2F;0确实会导致错误。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233732508.png" alt="image-20250106110858686" style="zoom:67%;" />

<p>由于C语言代码的原因，这段代码只可能出现崩溃，不可能超时，测试中也不会找到导致超时的用例。</p>
<hr>
<h1 id="Metasploit漏洞测试实验"><a href="#Metasploit漏洞测试实验" class="headerlink" title="Metasploit漏洞测试实验"></a>Metasploit漏洞测试实验</h1><h2 id="一、kali系统准备"><a href="#一、kali系统准备" class="headerlink" title="一、kali系统准备"></a>一、kali系统准备</h2><p>在 <a target="_blank" rel="noopener" href="https://www.kali.org/get-kali/#kali-installer-images">https://www.kali.org/get-kali/#kali-installer-images</a> 上获取镜像，在VMware上安装</p>
<p>安装过程没有截图，大部分按照默认设置。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233854890.png" alt="image-20250106123159236" style="zoom: 33%;" />

<h2 id="二、初始化并启动Metasploit"><a href="#二、初始化并启动Metasploit" class="headerlink" title="二、初始化并启动Metasploit"></a>二、初始化并启动Metasploit</h2><p>1 执行命令<strong>service postgresql start</strong>，启动postgresql，查看状态。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233858910.png" alt="image-20250106160735460" style="zoom: 80%;" />

<p>2 初始化数据库。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233903826.png" alt="image-20250106160928525" style="zoom:80%;" />

<p>3 进入msf框架。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233907310.png" alt="image-20250106161047394" style="zoom:67%;" />

<h2 id="三、挖掘MS08-067漏洞"><a href="#三、挖掘MS08-067漏洞" class="headerlink" title="三、挖掘MS08-067漏洞"></a>三、挖掘MS08-067漏洞</h2><p>1 受害机选择Windows XP Service Pack 2</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233910178.png" alt="image-20250106161929802" style="zoom: 80%;" />

<p>2 关闭windows的防火墙</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233914150.png" alt="image-20250106164851996" style="zoom:67%;" />

<p>3 获取kali机器和windows机器的ip地址，得到kali的ip为192.168.11.130，windows的ip为192.168.11.128</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233916813.png" alt="image-20250106164258153" style="zoom:80%;" />

<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233923966.png" alt="image-20250106164347279" style="zoom: 80%;" />

<p>4 两者互相可以ping通。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233919235.png" alt="image-20250106165620257" style="zoom:67%;" />

<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233934923.png" alt="image-20250106165654498" style="zoom:67%;" />

<p>5 查看windows系统中445端口状态，发现已经开启</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233942128.png" alt="image-20250106164729064" style="zoom:80%;" />

<p>6 在kali上利用nmap发现windows的445端口对外开放</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233946721.png" alt="image-20250106171643505" style="zoom:67%;" />

<p>7 在msf控制台中搜索ms08-067，找到一个对应模块</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233952143.png" alt="image-20250106172004799"></p>
<p>8 查看配置与目标</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403233956185.png" alt="image-20250106172702050" style="zoom:67%;" />

<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234002473.png" alt="image-20250106172724932" style="zoom:67%;" />

<p>9 设置两台机器的信息。</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234045369.png" alt="image-20250106174131811"></p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234048803.png" alt="image-20250106174332864" style="zoom:80%;" />

<p>根据上面show targets中给出的信息 配置target为对应xp系统版本</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234052206.png" alt="image-20250106174513328" style="zoom:80%;" />

<p>10 执行exploit</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234101352.png" alt="image-20250106175726187" style="zoom:67%;" />

<p>11 执行ipconfig sysinfo，可以看到xp系统的详细信息。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234105699.png" alt="image-20250106175818110" style="zoom:67%;" />

<p>12 在kali上，在windows的C盘中新建一个hack文件夹</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234109121.png" alt="image-20250106180038160" style="zoom:80%;" />

<p>13 在windows虚拟机上发现多了一个hack文件夹。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234113317.png" alt="image-20250106191335454" style="zoom:67%;" />



<hr>
<h1 id="Crackme破解实验"><a href="#Crackme破解实验" class="headerlink" title="Crackme破解实验"></a>Crackme破解实验</h1><p>实验选择160个程序中的第一个。</p>
<h2 id="一、前期准备"><a href="#一、前期准备" class="headerlink" title="一、前期准备"></a>一、前期准备</h2><p>在网络上下载吾爱破解版本的OllyDbg，并下载160个Crackme程序中的第一个。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234243749.png" alt="image-20250108220438131" style="zoom: 50%;" />

<h2 id="二、程序逻辑观察"><a href="#二、程序逻辑观察" class="headerlink" title="二、程序逻辑观察"></a>二、程序逻辑观察</h2><p>打开程序，观察其运行大概过程。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234246745.png" alt="image-20250108215231122" style="zoom:67%;" />

<p>点击第一个按钮，出现界面：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234249976.png" alt="image-20250108215322083" style="zoom:67%;" />

<p>点击第一个按钮出现如下报错，点击第二个按钮返回。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234252724.png" alt="image-20250108215339685" style="zoom:67%;" />

<p>点击主页第三个按钮，出现界面：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234255445.png" alt="image-20250108215426466" style="zoom:67%;" />

<p>点击第一个按钮出现如下报错，点击第二个按钮返回。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234257940.png" alt="image-20250108215456982" style="zoom:67%;" />

<h2 id="三、程序破解"><a href="#三、程序破解" class="headerlink" title="三、程序破解"></a>三、程序破解</h2><p>这次实验以Serial&#x2F;Name部分为例。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234300469.png" alt="image-20250108215339685" style="zoom:67%;" />

<p>这里是弹窗报错，判断对错的代码应该就在弹窗代码附近。在ollydbg中，查找相应字符串：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234304378.png" alt="image-20250108220855538" style="zoom:67%;" />

<p>定位到程序中：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234307020.png" alt="image-20250108220921866" style="zoom:67%;" />

<p>附近的代码0042FB07H 和 0042FB0CH中，引用的数据为：</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234310879.png" alt="image-20250108221123793"></p>
<p>这是代表成功的弹窗。</p>
<p>因此将0042FB03的jnz跳转语句修改为nop，不执行跳转，此时就会触发成功的弹窗。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234313282.png" alt="image-20250108221333083" style="zoom:67%;" />

<p>将修改保存到另一个文件：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234316283.png" alt="image-20250108221417212" style="zoom:67%;" />

<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234318604.png" alt="image-20250108221450417" style="zoom:67%;" />

<p>打开新的文件，发现出现了成功弹窗，绕过了判断。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234321366.png" alt="image-20250108221540306" style="zoom:67%;" />

<h2 id="四、注册机编写"><a href="#四、注册机编写" class="headerlink" title="四、注册机编写"></a>四、注册机编写</h2><p>这里我发现中文翻译版似乎存在bug，点击运行后程序的窗口不会跳出来，因此后续用英文版。</p>
<p>在上面发现的关键位置打上断点，程序运行到该位置：</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234324154.png" alt="image-20250108225216727"></p>
<p>查看寄存器状态，发现EAX中可能为正确的序列号。</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234327422.png" alt="image-20250108225249786"></p>
<p>输入后发现正确。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234330197.png" alt="image-20250108230336595" style="zoom:67%;" />

<p>但修改第一个输入框中的名字，同样的序列号则出错。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234332739.png" alt="image-20250108230424907" style="zoom:67%;" />

<p>代码中有两处相同的报错信息“Sorry…”，说明可能存在不同的出错原因。阅读代码发现原因在于长度小于4的名字会被直接判错。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234335067.png" alt="image-20250108234334017" style="zoom:67%;" />

<p>换一个输入，发现正确的序列号发生了变化，且只有中间的四个数字变化。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234337384.png" alt="image-20250108234944374" style="zoom:67%;" />

<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234339680.png" alt="image-20250108234846889"></p>
<p>接下来这一段代码中出现了两个“-”，说明这里可能实现的是拼接字符串的逻辑。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">0042FA7C  |.  8B83 DC010000 mov eax,dword ptr ds:[ebx+0x1DC]</span><br><span class="line">0042FA82  |.  E8 D1AFFEFF   call Acid_bur.0041AA58</span><br><span class="line">0042FA87  |.  8B45 F0       mov eax,[local.4]</span><br><span class="line">0042FA8A  |.  0FB600        movzx eax,byte ptr ds:[eax]</span><br><span class="line">0042FA8D  |.  F72D 50174300 imul dword ptr ds:[0x431750]</span><br><span class="line">0042FA93  |.  A3 50174300   mov dword ptr ds:[0x431750],eax</span><br><span class="line">0042FA98  |.  A1 50174300   mov eax,dword ptr ds:[0x431750]</span><br><span class="line">0042FA9D  |.  0105 50174300 add dword ptr ds:[0x431750],eax</span><br><span class="line">0042FAA3  |.  8D45 FC       lea eax,[local.1]</span><br><span class="line">0042FAA6  |.  BA ACFB4200   mov edx,Acid_bur.0042FBAC</span><br><span class="line">0042FAAB  |.  E8 583CFDFF   call Acid_bur.00403708</span><br><span class="line">0042FAB0  |.  8D45 F8       lea eax,[local.2]</span><br><span class="line">0042FAB3  |.  BA B8FB4200   mov edx,Acid_bur.0042FBB8</span><br><span class="line">0042FAB8  |.  E8 4B3CFDFF   call Acid_bur.00403708</span><br><span class="line">0042FABD  |.  FF75 FC       push [local.1]                           ;  kernel32.BaseThreadInitThunk</span><br><span class="line">0042FAC0  |.  68 C8FB4200   push Acid_bur.0042FBC8                   ;  UNICODE &quot;-&quot;</span><br><span class="line">0042FAC5  |.  8D55 E8       lea edx,[local.6]</span><br><span class="line">0042FAC8  |.  A1 50174300   mov eax,dword ptr ds:[0x431750]</span><br><span class="line">0042FACD  |.  E8 466CFDFF   call Acid_bur.00406718</span><br><span class="line">0042FAD2  |.  FF75 E8       push [local.6]</span><br><span class="line">0042FAD5  |.  68 C8FB4200   push Acid_bur.0042FBC8                   ;  UNICODE &quot;-&quot;</span><br><span class="line">0042FADA  |.  FF75 F8       push [local.2]</span><br><span class="line">0042FADD  |.  8D45 F4       lea eax,[local.3]</span><br><span class="line">0042FAE0  |.  BA 05000000   mov edx,0x5</span><br><span class="line">0042FAE5  |.  E8 C23EFDFF   call Acid_bur.004039AC</span><br><span class="line">0042FAEA  |.  8D55 F0       lea edx,[local.4]</span><br><span class="line">0042FAED  |.  8B83 E0010000 mov eax,dword ptr ds:[ebx+0x1E0]</span><br><span class="line">0042FAF3  |.  E8 60AFFEFF   call Acid_bur.0041AA58</span><br><span class="line">0042FAF8  |.  8B55 F0       mov edx,[local.4]</span><br><span class="line">0042FAFB  |.  8B45 F4       mov eax,[local.3]                        ;  kernel32.769A7BA9</span><br><span class="line">0042FAFE  |.  E8 F93EFDFF   call Acid_bur.004039FC</span><br></pre></td></tr></table></figure>

<p>ebx+0x1DC 这个地址出现多次，可能是比较重要的地方。若将其认为是name存储的地方，接下来的逻辑可以说通。</p>
<p>这段代码中0x431750出现多次：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0042FA87  |.  8B45 F0       mov eax,[local.4]</span><br><span class="line">0042FA8A  |.  0FB600        movzx eax,byte ptr ds:[eax]</span><br><span class="line">0042FA8D  |.  F72D 50174300 imul dword ptr ds:[0x431750]</span><br><span class="line">0042FA93  |.  A3 50174300   mov dword ptr ds:[0x431750],eax</span><br><span class="line">0042FA98  |.  A1 50174300   mov eax,dword ptr ds:[0x431750]</span><br><span class="line">0042FA9D  |.  0105 50174300 add dword ptr ds:[0x431750],eax</span><br></pre></td></tr></table></figure>

<p>在此处打上断点，查看内存状态：</p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234343403.png" alt="image-20250109002002335"></p>
<p><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234345615.png" alt="image-20250109002037741"></p>
<p>计算机为小端序存储，故此处数据为0x29。</p>
<p>故这段代码含义为：取name的第一个字符的ascii码，乘以0x29（41），再×2。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0042FA87  |.  8B45 F0       mov eax,[local.4]</span><br><span class="line">0042FA8A  |.  0FB600        movzx eax,byte ptr ds:[eax]</span><br><span class="line">0042FA8D  |.  F72D 50174300 imul dword ptr ds:[0x431750]</span><br><span class="line">0042FA93  |.  A3 50174300   mov dword ptr ds:[0x431750],eax</span><br><span class="line">0042FA98  |.  A1 50174300   mov eax,dword ptr ds:[0x431750]</span><br><span class="line">0042FA9D  |.  0105 50174300 add dword ptr ds:[0x431750],eax</span><br></pre></td></tr></table></figure>

<p>取上面的样例验证：</p>
<p>P对应的ascii码为80，乘以41再乘以2，结果为6560，符合。</p>
<p>1对应ascii码为49，乘以41再乘以2，结果为4018，符合。</p>
<p>用我自己的名字测试，同样符合规律：</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234349273.png" alt="image-20250109002655515" style="zoom:67%;" />

<p>所以注册机的C语言实现如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">my_register</span><span class="params">(<span class="type">char</span>* name)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> input[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter your name: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, input);</span><br><span class="line"></span><br><span class="line">    my_register(input);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">my_register</span><span class="params">(<span class="type">char</span>* name)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>(name) &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Error: Name length must be at least 4 characters.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ori = (<span class="type">int</span>)name[<span class="number">0</span>];</span><br><span class="line">    ori *= <span class="number">82</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;CW-%d-CRACKED\n&quot;</span>, ori);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码也给出了正确的结果。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234352895.png" alt="image-20250109004154638" style="zoom:67%;" />



<hr>
<h1 id="熊猫烧香实验"><a href="#熊猫烧香实验" class="headerlink" title="熊猫烧香实验"></a>熊猫烧香实验</h1><h2 id="一-病毒观察"><a href="#一-病毒观察" class="headerlink" title="一 病毒观察"></a>一 病毒观察</h2><p>在WinXP系统上观察病毒特征。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234512592.png" alt="image-20250109102152748" style="zoom:67%;" />

<p>将病毒文件复制到虚拟机中并打开。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234515825.png" alt="image-20250109102249968" style="zoom:67%;" />

<p>在任务管理器中可以看到熊猫烧香的进程。过一段时间，任务管理器被自动关闭，应该是病毒的作用。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234518471.png" alt="image-20250109102354254" style="zoom:67%;" />

<p>同时，隐藏文件不会被显示。选择显示所有文件后，点击确定，但隐藏文件并没有显示。再次打开文件夹选项，发现仍然隐藏。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234521750.png" alt="image-20250109102928536" style="zoom:67%;" />

<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234526473.png" alt="image-20250109103021226" style="zoom:67%;" />

<p>Windows安全中心也被关闭，重启后也没有用。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234528907.png" alt="image-20250109103910095" style="zoom:67%;" />

<p>病毒运行一段时间后发现已经无法打开C盘查看文件。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234531413.png" alt="image-20250109110304443" style="zoom:67%;" />

<h2 id="二-病毒分析"><a href="#二-病毒分析" class="headerlink" title="二 病毒分析"></a>二 病毒分析</h2><p>在Win10上用OllyDBG打开老师给的病毒样本，查找所有字符串。</p>
<p>图中可以看到，当时的主流杀毒软件都在病毒考虑范围之内，查资料发现病毒会关闭这些软件，删除启动项。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234534146.png" alt="image-20250109103738237" style="zoom:80%;" />

<p>追踪到这些ASCII码的位置，这是“防火墙”所在部分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">0040634A  |.  8B55 90       |mov edx,[local.28]</span><br><span class="line">0040634D  |.  B8 186C4000   |mov eax,41f718bc.00406C18               ;  ASCII &quot;防火墙&quot;</span><br><span class="line">00406352  |.  E8 5DDEFFFF   |call 41f718bc.004041B4</span><br><span class="line">00406357  |.  85C0          |test eax,eax</span><br><span class="line">00406359  |.  74 0C         |je short 41f718bc.00406367</span><br><span class="line">0040635B  |.  6A 00         |push 0x0                                ; /lParam = 0x0</span><br><span class="line">0040635D  |.  6A 00         |push 0x0                                ; |wParam = 0x0</span><br><span class="line">0040635F  |.  6A 12         |push 0x12                               ; |Message = WM_QUIT</span><br><span class="line">00406361  |.  53            |push ebx                                ; |hWnd = 0x7FFDE000</span><br><span class="line">00406362  |.  E8 D5E8FFFF   |call &lt;jmp.&amp;user32.PostMessageA&gt;         ; \PostMessageA</span><br><span class="line">00406367  |&gt;  8D45 8C       |lea eax,[local.29]</span><br><span class="line">0040636A  |.  8BD6          |mov edx,esi                             ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">0040636C  |.  B9 65000000   |mov ecx,0x65</span><br><span class="line">00406371  |.  E8 3EDBFFFF   |call 41f718bc.00403EB4</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>猜测这里调用的函数可能比较关键，但发现都只是简单的字符串比较，因此关键部分应该在后面。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">00406951  |.  6A 00         |push 0x0                                ; /lParam = 0x0</span><br><span class="line">00406953  |.  6A 00         |push 0x0                                ; |wParam = 0x0</span><br><span class="line">00406955  |.  6A 12         |push 0x12                               ; |Message = WM_QUIT</span><br><span class="line">00406957  |.  53            |push ebx                                ; |hWnd = 0x7FFDE000</span><br><span class="line">00406958  |.  E8 DFE2FFFF   |call &lt;jmp.&amp;user32.PostMessageA&gt;         ; \PostMessageA</span><br><span class="line">0040695D  |&gt;  85DB          |test ebx,ebx</span><br><span class="line">0040695F  |.^ 0F85 94F9FFFF \jnz 41f718bc.004062F9</span><br><span class="line">00406965  |.  E8 AAE2FFFF   call &lt;jmp.&amp;user32.GetDesktopWindow&gt;      ; [GetDesktopWindow</span><br><span class="line">0040696A  |.  8BF8          mov edi,eax</span><br><span class="line">0040696C  |&gt;  6A 00         /push 0x0                                ; /Title = NULL</span><br><span class="line">0040696E  |.  6A 00         |push 0x0                                ; |Class = 0x0</span><br><span class="line">00406970  |.  53            |push ebx                                ; |hAfterWnd = 7FFDE000</span><br><span class="line">00406971  |.  57            |push edi                                ; |hParent = 0040CB48</span><br><span class="line">00406972  |.  E8 95E2FFFF   |call &lt;jmp.&amp;user32.FindWindowExA&gt;        ; \FindWindowExA</span><br><span class="line">00406977  |.  8BD8          |mov ebx,eax</span><br><span class="line">00406979  |.  6A 00         |push 0x0                                ; /Title = NULL</span><br><span class="line">0040697B  |.  68 906E4000   |push 41f718bc.00406E90                  ; |Class = &quot;msctls_statusbar32&quot;</span><br><span class="line">00406980  |.  6A 00         |push 0x0                                ; |hAfterWnd = NULL</span><br><span class="line">00406982  |.  53            |push ebx                                ; |hParent = 7FFDE000</span><br><span class="line">00406983  |.  E8 84E2FFFF   |call &lt;jmp.&amp;user32.FindWindowExA&gt;        ; \FindWindowExA</span><br><span class="line">00406988  |.  6A 00         |push 0x0                                ; /Title = NULL</span><br><span class="line">0040698A  |.  6A 00         |push 0x0                                ; |Class = 0x0</span><br><span class="line">0040698C  |.  6A 00         |push 0x0                                ; |hAfterWnd = NULL</span><br><span class="line">0040698E  |.  50            |push eax                                ; |hParent = 4DC5976E</span><br><span class="line">0040698F  |.  E8 78E2FFFF   |call &lt;jmp.&amp;user32.FindWindowExA&gt;        ; \FindWindowExA</span><br><span class="line">00406994  |.  6A 65         |push 0x65                               ; /Count = 65 (101.)</span><br><span class="line">00406996  |.  56            |push esi                                ; |Buffer = 41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">00406997  |.  50            |push eax                                ; |hWnd = 4DC5976E</span><br><span class="line">00406998  |.  E8 87E2FFFF   |call &lt;jmp.&amp;user32.GetWindowTextA&gt;       ; \GetWindowTextA</span><br><span class="line">0040699D  |.  8D85 10FFFFFF |lea eax,[local.60]</span><br><span class="line">004069A3  |.  8BD6          |mov edx,esi                             ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004069A5  |.  B9 65000000   |mov ecx,0x65</span><br><span class="line">004069AA  |.  E8 05D5FFFF   |call 41f718bc.00403EB4</span><br><span class="line">004069AF  |.  8B95 10FFFFFF |mov edx,[local.60]</span><br><span class="line">004069B5  |.  B8 AC6E4000   |mov eax,41f718bc.00406EAC               ;  ASCII &quot;pjf(ustc)&quot;</span><br><span class="line">004069BA  |.  E8 F5D7FFFF   |call 41f718bc.004041B4</span><br><span class="line">004069BF  |.  85C0          |test eax,eax</span><br><span class="line">004069C1  |.  0F84 C4000000 |je 41f718bc.00406A8B</span><br><span class="line">004069C7  |.  6A 00         |push 0x0                                ; /lParam = 0x0</span><br><span class="line">004069C9  |.  6A 00         |push 0x0                                ; |wParam = 0x0</span><br><span class="line">004069CB  |.  6A 12         |push 0x12                               ; |Message = WM_QUIT</span><br><span class="line">004069CD  |.  53            |push ebx                                ; |hWnd = 0x7FFDE000</span><br><span class="line">004069CE  |.  E8 69E2FFFF   |call &lt;jmp.&amp;user32.PostMessageA&gt;         ; \PostMessageA</span><br><span class="line">004069D3  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">004069D5  |.  6A 00         |push 0x0                                ; |Flags = 0</span><br><span class="line">004069D7  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">004069D9  |.  6A 11         |push 0x11                               ; ||Key = 0x11</span><br><span class="line">004069DB  |.  E8 54E2FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">004069E0  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">004069E1  |.  6A 11         |push 0x11                               ; |Key = VK_CONTROL</span><br><span class="line">004069E3  |.  E8 64E2FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">004069E8  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">004069EA  |.  6A 00         |push 0x0                                ; |Flags = 0</span><br><span class="line">004069EC  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">004069EE  |.  6A 12         |push 0x12                               ; ||Key = 0x12</span><br><span class="line">004069F0  |.  E8 3FE2FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">004069F5  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">004069F6  |.  6A 12         |push 0x12                               ; |Key = VK_MENU</span><br><span class="line">004069F8  |.  E8 4FE2FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">004069FD  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">004069FF  |.  6A 00         |push 0x0                                ; |Flags = 0</span><br><span class="line">00406A01  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">00406A03  |.  6A 44         |push 0x44                               ; ||Key = 0x44</span><br><span class="line">00406A05  |.  E8 2AE2FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">00406A0A  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">00406A0B  |.  6A 44         |push 0x44                               ; |Key = 44  (&#x27;D&#x27;)</span><br><span class="line">00406A0D  |.  E8 3AE2FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">00406A12  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">00406A14  |.  6A 02         |push 0x2                                ; |Flags = KEYEVENTF_KEYUP</span><br><span class="line">00406A16  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">00406A18  |.  6A 44         |push 0x44                               ; ||Key = 0x44</span><br><span class="line">00406A1A  |.  E8 15E2FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">00406A1F  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">00406A20  |.  6A 44         |push 0x44                               ; |Key = 44  (&#x27;D&#x27;)</span><br><span class="line">00406A22  |.  E8 25E2FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">00406A27  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">00406A29  |.  6A 02         |push 0x2                                ; |Flags = KEYEVENTF_KEYUP</span><br><span class="line">00406A2B  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">00406A2D  |.  6A 11         |push 0x11                               ; ||Key = 0x11</span><br><span class="line">00406A2F  |.  E8 00E2FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">00406A34  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">00406A35  |.  6A 11         |push 0x11                               ; |Key = VK_CONTROL</span><br><span class="line">00406A37  |.  E8 10E2FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">00406A3C  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">00406A3E  |.  6A 02         |push 0x2                                ; |Flags = KEYEVENTF_KEYUP</span><br><span class="line">00406A40  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">00406A42  |.  6A 12         |push 0x12                               ; ||Key = 0x12</span><br><span class="line">00406A44  |.  E8 EBE1FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">00406A49  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">00406A4A  |.  6A 12         |push 0x12                               ; |Key = VK_MENU</span><br><span class="line">00406A4C  |.  E8 FBE1FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">00406A51  |.  68 B86E4000   |push 41f718bc.00406EB8                  ; /Title = &quot;IceSword&quot;</span><br><span class="line">00406A56  |.  6A 00         |push 0x0                                ; |Class = 0x0</span><br><span class="line">00406A58  |.  E8 A7E1FFFF   |call &lt;jmp.&amp;user32.FindWindowA&gt;          ; \FindWindowA</span><br><span class="line">00406A5D  |.  85C0          |test eax,eax</span><br><span class="line">00406A5F  |.  74 2A         |je short 41f718bc.00406A8B</span><br><span class="line">00406A61  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">00406A63  |.  6A 00         |push 0x0                                ; |Flags = 0</span><br><span class="line">00406A65  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">00406A67  |.  6A 0D         |push 0xD                                ; ||Key = 0xD</span><br><span class="line">00406A69  |.  E8 C6E1FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">00406A6E  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">00406A6F  |.  6A 0D         |push 0xD                                ; |Key = VK_RETURN</span><br><span class="line">00406A71  |.  E8 D6E1FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">00406A76  |.  6A 00         |push 0x0                                ; /ExtraInfo = 0x0</span><br><span class="line">00406A78  |.  6A 02         |push 0x2                                ; |Flags = KEYEVENTF_KEYUP</span><br><span class="line">00406A7A  |.  6A 00         |push 0x0                                ; |/Action = 0x0</span><br><span class="line">00406A7C  |.  6A 0D         |push 0xD                                ; ||Key = 0xD</span><br><span class="line">00406A7E  |.  E8 B1E1FFFF   |call &lt;jmp.&amp;user32.MapVirtualKeyA&gt;       ; |\MapVirtualKeyA</span><br><span class="line">00406A83  |.  50            |push eax                                ; |ScanCode = 4DC5976E (1304794990.)</span><br><span class="line">00406A84  |.  6A 0D         |push 0xD                                ; |Key = VK_RETURN</span><br><span class="line">00406A86  |.  E8 C1E1FFFF   |call &lt;jmp.&amp;user32.keybd_event&gt;          ; \keybd_event</span><br><span class="line">00406A8B  |&gt;  85DB          |test ebx,ebx</span><br><span class="line">00406A8D  |.^ 0F85 D9FEFFFF \jnz 41f718bc.0040696C</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到病毒调用 <code>FindWindowA</code> 和 <code>FindWindowExA</code> 查找特定窗口，并向窗口发送 <code>WM_QUIT</code> 消息来尝试终止。</p>
<p>后面还有一段代码，实现了关闭关键进程的逻辑。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234540481.png" alt="image-20250109111412273" style="zoom:67%;" />

<p>追踪调用的函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">004060D4  /$  55            push ebp</span><br><span class="line">004060D5  |.  8BEC          mov ebp,esp</span><br><span class="line">004060D7  |.  81C4 C0FEFFFF add esp,-0x140</span><br><span class="line">004060DD  |.  53            push ebx</span><br><span class="line">004060DE  |.  56            push esi                                 ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004060DF  |.  33D2          xor edx,edx                              ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004060E1  |.  8995 D0FEFFFF mov [local.76],edx                       ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004060E7  |.  8995 C8FEFFFF mov [local.78],edx                       ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004060ED  |.  8995 C4FEFFFF mov [local.79],edx                       ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004060F3  |.  8995 C0FEFFFF mov [local.80],edx                       ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004060F9  |.  8995 CCFEFFFF mov [local.77],edx                       ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004060FF  |.  8945 FC       mov [local.1],eax</span><br><span class="line">00406102  |.  8B45 FC       mov eax,[local.1]</span><br><span class="line">00406105  |.  E8 B2DFFFFF   call 41f718bc.004040BC</span><br><span class="line">0040610A  |.  8D9D D4FEFFFF lea ebx,[local.75]</span><br><span class="line">00406110  |.  33C0          xor eax,eax</span><br><span class="line">00406112  |.  55            push ebp</span><br><span class="line">00406113  |.  68 06624000   push 41f718bc.00406206</span><br><span class="line">00406118  |.  64:FF30       push dword ptr fs:[eax]</span><br><span class="line">0040611B  |.  64:8920       mov dword ptr fs:[eax],esp</span><br><span class="line">0040611E  |.  33D2          xor edx,edx                              ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">00406120  |.  B8 02000000   mov eax,0x2</span><br><span class="line">00406125  |.  E8 FEEEFFFF   call 41f718bc.00405028</span><br><span class="line">0040612A  |.  8BF0          mov esi,eax</span><br><span class="line">0040612C  |.  C703 28010000 mov dword ptr ds:[ebx],0x128</span><br><span class="line">00406132  |.  8BD3          mov edx,ebx</span><br><span class="line">00406134  |.  8BC6          mov eax,esi                              ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">00406136  |.  E8 0DEFFFFF   call 41f718bc.00405048</span><br><span class="line">0040613B  |.  83F8 01       cmp eax,0x1</span><br><span class="line">0040613E  |.  1BC0          sbb eax,eax</span><br><span class="line">00406140  |.  40            inc eax</span><br><span class="line">00406141  |.  E9 8A000000   jmp 41f718bc.004061D0</span><br><span class="line">00406146  |&gt;  8D95 CCFEFFFF /lea edx,[local.77]</span><br><span class="line">0040614C  |.  8B45 FC       |mov eax,[local.1]</span><br><span class="line">0040614F  |.  E8 D4FEFFFF   |call 41f718bc.00406028</span><br><span class="line">00406154  |.  8B85 CCFEFFFF |mov eax,[local.77]</span><br><span class="line">0040615A  |.  8D95 D0FEFFFF |lea edx,[local.76]</span><br><span class="line">00406160  |.  E8 43FEFFFF   |call 41f718bc.00405FA8</span><br><span class="line">00406165  |.  8B85 D0FEFFFF |mov eax,[local.76]</span><br><span class="line">0040616B  |.  50            |push eax</span><br><span class="line">0040616C  |.  8D85 C0FEFFFF |lea eax,[local.80]</span><br><span class="line">00406172  |.  8D53 24       |lea edx,dword ptr ds:[ebx+0x24]</span><br><span class="line">00406175  |.  B9 04010000   |mov ecx,0x104</span><br><span class="line">0040617A  |.  E8 35DDFFFF   |call 41f718bc.00403EB4</span><br><span class="line">0040617F  |.  8B85 C0FEFFFF |mov eax,[local.80]</span><br><span class="line">00406185  |.  8D95 C4FEFFFF |lea edx,[local.79]</span><br><span class="line">0040618B  |.  E8 98FEFFFF   |call 41f718bc.00406028</span><br><span class="line">00406190  |.  8B85 C4FEFFFF |mov eax,[local.79]</span><br><span class="line">00406196  |.  8D95 C8FEFFFF |lea edx,[local.78]</span><br><span class="line">0040619C  |.  E8 07FEFFFF   |call 41f718bc.00405FA8</span><br><span class="line">004061A1  |.  8B95 C8FEFFFF |mov edx,[local.78]</span><br><span class="line">004061A7  |.  58            |pop eax                                 ;  kernel32.75833744</span><br><span class="line">004061A8  |.  E8 6BDEFFFF   |call 41f718bc.00404018</span><br><span class="line">004061AD  |.  75 12         |jnz short 41f718bc.004061C1</span><br><span class="line">004061AF  |.  8B43 08       |mov eax,dword ptr ds:[ebx+0x8]          ;  41f718bc.00400000</span><br><span class="line">004061B2  |.  E8 FDFEFFFF   |call 41f718bc.004060B4</span><br><span class="line">004061B7  |.  8BD8          |mov ebx,eax</span><br><span class="line">004061B9  |.  56            |push esi                                ; /hObject = 0040CB48</span><br><span class="line">004061BA  |.  E8 1DE9FFFF   |call &lt;jmp.&amp;kernel32.CloseHandle&gt;        ; \CloseHandle</span><br><span class="line">004061BF  |.  EB 1F         |jmp short 41f718bc.004061E0</span><br><span class="line">004061C1  |&gt;  8BD3          |mov edx,ebx</span><br><span class="line">004061C3  |.  8BC6          |mov eax,esi                             ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004061C5  |.  E8 9EEEFFFF   |call 41f718bc.00405068</span><br><span class="line">004061CA  |.  83F8 01       |cmp eax,0x1</span><br><span class="line">004061CD  |.  1BC0          |sbb eax,eax</span><br><span class="line">004061CF  |.  40            |inc eax</span><br><span class="line">004061D0  |&gt;  84C0           test al,al</span><br><span class="line">004061D2  |.^ 0F85 6EFFFFFF \jnz 41f718bc.00406146</span><br><span class="line">004061D8  |.  56            push esi                                 ; /hObject = 0040CB48</span><br><span class="line">004061D9  |.  E8 FEE8FFFF   call &lt;jmp.&amp;kernel32.CloseHandle&gt;         ; \CloseHandle</span><br><span class="line">004061DE  |.  B3 01         mov bl,0x1</span><br><span class="line">004061E0  |&gt;  33C0          xor eax,eax</span><br><span class="line">004061E2  |.  5A            pop edx                                  ;  kernel32.75833744</span><br><span class="line">004061E3  |.  59            pop ecx                                  ;  kernel32.75833744</span><br><span class="line">004061E4  |.  59            pop ecx                                  ;  kernel32.75833744</span><br><span class="line">004061E5  |.  64:8910       mov dword ptr fs:[eax],edx               ;  41f718bc.&lt;ModuleEntryPoint&gt;</span><br><span class="line">004061E8  |.  68 0D624000   push 41f718bc.0040620D</span><br><span class="line">004061ED  |&gt;  8D85 C0FEFFFF lea eax,[local.80]</span><br><span class="line">004061F3  |.  BA 05000000   mov edx,0x5</span><br><span class="line">004061F8  |.  E8 6BDAFFFF   call 41f718bc.00403C68</span><br><span class="line">004061FD  |.  8D45 FC       lea eax,[local.1]</span><br><span class="line">00406200  |.  E8 3FDAFFFF   call 41f718bc.00403C44</span><br><span class="line">00406205  \.  C3            retn</span><br></pre></td></tr></table></figure>

<p>其中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">004061D9  |.  E8 FEE8FFFF   call &lt;jmp.&amp;kernel32.CloseHandle&gt;         ; \CloseHandle</span><br></pre></td></tr></table></figure>

<p>这一行是关键，可以看出病毒在此处结束了一些可能影响自己运行的进程。</p>
<p>这里大概可以看出，病毒在一些关键位置感染文件，会新建Desktop_.ini文件。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234545528.png" alt="image-20250109104320922" style="zoom: 80%;" />

<p>定位到附近，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">00409886   .  FF75 FC       push dword ptr ss:[ebp-0x4]</span><br><span class="line">00409889   .  FFB5 A8FEFFFF push dword ptr ss:[ebp-0x158]</span><br><span class="line">0040988F   .  68 94A04000   push 41f718bc.0040A094                   ;  ASCII 5C,&quot;Desktop_.ini&quot;</span><br><span class="line">00409894   .  8D85 C0FDFFFF lea eax,dword ptr ss:[ebp-0x240]</span><br><span class="line">0040989A   .  BA 03000000   mov edx,0x3</span><br><span class="line">0040989F   .  E8 E8A6FFFF   call 41f718bc.00403F8C</span><br><span class="line">004098A4   .  8B85 C0FDFFFF mov eax,dword ptr ss:[ebp-0x240]</span><br><span class="line">004098AA   .  E8 1DA8FFFF   call 41f718bc.004040CC</span><br><span class="line">004098AF   .  50            push eax                                 ; |FileName = 4DC5976E ???</span><br><span class="line">004098B0   .  E8 FFB2FFFF   call &lt;jmp.&amp;kernel32.SetFileAttributesA&gt;  ; \SetFileAttributesA</span><br><span class="line">004098B5   .  6A 01         push 0x1                                 ; /Timeout = 1. ms</span><br><span class="line">004098B7   .  E8 08B3FFFF   call &lt;jmp.&amp;kernel32.Sleep&gt;               ; \Sleep</span><br><span class="line">004098BC   .  8D85 8CFEFFFF lea eax,dword ptr ss:[ebp-0x174]</span><br><span class="line">004098C2   .  50            push eax                                 ; /pLocaltime = 4DC5976E</span><br><span class="line">004098C3   .  E8 9CB2FFFF   call &lt;jmp.&amp;kernel32.GetLocalTime&gt;        ; \GetLocalTime</span><br><span class="line">004098C8   .  8D95 BCFDFFFF lea edx,dword ptr ss:[ebp-0x244]</span><br><span class="line">004098CE   .  0FB785 8CFEFF&gt;movzx eax,word ptr ss:[ebp-0x174]</span><br><span class="line">004098D5   .  E8 A2BFFFFF   call 41f718bc.0040587C</span><br><span class="line">004098DA   .  FFB5 BCFDFFFF push dword ptr ss:[ebp-0x244]</span><br><span class="line">004098E0   .  68 ACA04000   push 41f718bc.0040A0AC                   ;  UNICODE &quot;-&quot;</span><br><span class="line">004098E5   .  8D95 B8FDFFFF lea edx,dword ptr ss:[ebp-0x248]</span><br><span class="line">004098EB   .  0FB785 8EFEFF&gt;movzx eax,word ptr ss:[ebp-0x172]</span><br><span class="line">004098F2   .  E8 85BFFFFF   call 41f718bc.0040587C</span><br><span class="line">004098F7   .  FFB5 B8FDFFFF push dword ptr ss:[ebp-0x248]</span><br><span class="line">004098FD   .  68 ACA04000   push 41f718bc.0040A0AC                   ;  UNICODE &quot;-&quot;</span><br><span class="line">00409902   .  8D95 B4FDFFFF lea edx,dword ptr ss:[ebp-0x24C]</span><br><span class="line">00409908   .  0FB785 92FEFF&gt;movzx eax,word ptr ss:[ebp-0x16E]</span><br><span class="line">0040990F   .  E8 68BFFFFF   call 41f718bc.0040587C</span><br><span class="line">00409914   .  FFB5 B4FDFFFF push dword ptr ss:[ebp-0x24C]</span><br><span class="line">0040991A   .  8D45 F4       lea eax,dword ptr ss:[ebp-0xC]</span><br><span class="line">0040991D   .  BA 05000000   mov edx,0x5</span><br><span class="line">00409922   .  E8 65A6FFFF   call 41f718bc.00403F8C</span><br></pre></td></tr></table></figure>

<p>发现这段代码中有设置时间戳、设置文件属性的部分，病毒应该在这里将文件的属性设为了隐藏。</p>
<p>下面这段代码中出现了gamesetup.exe和spoclsv.exe，且存在复制的行为，可能是病毒复制自身的地方。</p>
<img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403234551277.png" alt="image-20250109131621011" style="zoom: 67%;" />
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/">软件安全</a><a class="post-meta__tags" href="/tags/AFL/">AFL</a><a class="post-meta__tags" href="/tags/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95/">模糊测试</a><a class="post-meta__tags" href="/tags/Crackme/">Crackme</a><a class="post-meta__tags" href="/tags/Metasploit/">Metasploit</a><a class="post-meta__tags" href="/tags/kali/">kali</a><a class="post-meta__tags" href="/tags/MS08-067/">MS08-067</a><a class="post-meta__tags" href="/tags/%E6%BC%8F%E6%B4%9E/">漏洞</a><a class="post-meta__tags" href="/tags/%E7%86%8A%E7%8C%AB%E7%83%A7%E9%A6%99/">熊猫烧香</a><a class="post-meta__tags" href="/tags/OllyDBG/">OllyDBG</a><a class="post-meta__tags" href="/tags/DVWA/">DVWA</a><a class="post-meta__tags" href="/tags/Seay/">Seay</a><a class="post-meta__tags" href="/tags/RIPS/">RIPS</a><a class="post-meta__tags" href="/tags/CodeXploiter/">CodeXploiter</a></div><div class="post-share"><div class="social-share" data-image="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232317140.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/04/03/graduate-proj-exp/" title="毕设前端经验总结"><img class="cover" src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403202302474.jpg" onerror="onerror=null;src='https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250402112720227.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">毕设前端经验总结</div></div><div class="info-2"><div class="info-item-1">本文大致总结了一些写毕设前端的时候碰到的问题以及相应的解决方案。</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250402112624099.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">shingeki</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/youzhoujiMrLiu"><i class="fab fa-github"></i><span>我的Github主页</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DVWA%E5%AE%9E%E9%AA%8C"><span class="toc-number">1.</span> <span class="toc-text">DVWA实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81DVWA%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.</span> <span class="toc-text">一、DVWA安装配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%A9%E7%94%A8Seay%E8%BF%9B%E8%A1%8C%E6%BA%90%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5"><span class="toc-number">1.2.</span> <span class="toc-text">二、利用Seay进行源代码审查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%A9%E7%94%A8RIPS%E8%BF%9B%E8%A1%8C%E6%BA%90%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5"><span class="toc-number">1.3.</span> <span class="toc-text">三、利用RIPS进行源代码审查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%88%A9%E7%94%A8CodeXploiter%E8%BF%9B%E8%A1%8C%E6%BA%90%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5"><span class="toc-number">1.4.</span> <span class="toc-text">四、利用CodeXploiter进行源代码审查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94"><span class="toc-number">1.5.</span> <span class="toc-text">五、工具对比</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AFL%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A"><span class="toc-number">2.</span> <span class="toc-text">AFL实验报告</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">2.1.</span> <span class="toc-text">一、环境准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81C%E7%A8%8B%E5%BA%8F%E5%87%86%E5%A4%87"><span class="toc-number">2.2.</span> <span class="toc-text">二、C程序准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-number">2.3.</span> <span class="toc-text">三、测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90"><span class="toc-number">2.4.</span> <span class="toc-text">四、结果分析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Metasploit%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95%E5%AE%9E%E9%AA%8C"><span class="toc-number">3.</span> <span class="toc-text">Metasploit漏洞测试实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81kali%E7%B3%BB%E7%BB%9F%E5%87%86%E5%A4%87"><span class="toc-number">3.1.</span> <span class="toc-text">一、kali系统准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B9%B6%E5%90%AF%E5%8A%A8Metasploit"><span class="toc-number">3.2.</span> <span class="toc-text">二、初始化并启动Metasploit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%8C%96%E6%8E%98MS08-067%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.3.</span> <span class="toc-text">三、挖掘MS08-067漏洞</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crackme%E7%A0%B4%E8%A7%A3%E5%AE%9E%E9%AA%8C"><span class="toc-number">4.</span> <span class="toc-text">Crackme破解实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87"><span class="toc-number">4.1.</span> <span class="toc-text">一、前期准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E8%A7%82%E5%AF%9F"><span class="toc-number">4.2.</span> <span class="toc-text">二、程序逻辑观察</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%A8%8B%E5%BA%8F%E7%A0%B4%E8%A7%A3"><span class="toc-number">4.3.</span> <span class="toc-text">三、程序破解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%B3%A8%E5%86%8C%E6%9C%BA%E7%BC%96%E5%86%99"><span class="toc-number">4.4.</span> <span class="toc-text">四、注册机编写</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%86%8A%E7%8C%AB%E7%83%A7%E9%A6%99%E5%AE%9E%E9%AA%8C"><span class="toc-number">5.</span> <span class="toc-text">熊猫烧香实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E7%97%85%E6%AF%92%E8%A7%82%E5%AF%9F"><span class="toc-number">5.1.</span> <span class="toc-text">一 病毒观察</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90"><span class="toc-number">5.2.</span> <span class="toc-text">二 病毒分析</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/04/03/software-safety-reports/" title="软件安全课程报告汇总"><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403232317140.jpg" onerror="this.onerror=null;this.src='https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250402112720227.jpg'" alt="软件安全课程报告汇总"/></a><div class="content"><a class="title" href="/2025/04/03/software-safety-reports/" title="软件安全课程报告汇总">软件安全课程报告汇总</a><time datetime="2025-04-03T15:14:39.000Z" title="发表于 2025-04-03 23:14:39">2025-04-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/03/graduate-proj-exp/" title="毕设前端经验总结"><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250403202302474.jpg" onerror="this.onerror=null;this.src='https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250402112720227.jpg'" alt="毕设前端经验总结"/></a><div class="content"><a class="title" href="/2025/04/03/graduate-proj-exp/" title="毕设前端经验总结">毕设前端经验总结</a><time datetime="2025-04-03T12:17:13.000Z" title="发表于 2025-04-03 20:17:13">2025-04-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/02/butterfly-learning/" title="hexo及butterfly主题使用踩坑记录"><img src="https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250402112813911.jpg" onerror="this.onerror=null;this.src='https://shingeki-pic.oss-cn-nanjing.aliyuncs.com/img/20250402112720227.jpg'" alt="hexo及butterfly主题使用踩坑记录"/></a><div class="content"><a class="title" href="/2025/04/02/butterfly-learning/" title="hexo及butterfly主题使用踩坑记录">hexo及butterfly主题使用踩坑记录</a><time datetime="2025-04-01T16:09:58.000Z" title="发表于 2025-04-02 00:09:58">2025-04-02</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2025 By shingeki</div><div class="footer_custom_text">Powered by Hexo & Butterfly.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>